#!/usr/bin/env bash

set -eux

mkdir -p "$ASDF_DOWNLOAD_PATH"

host_zig_triple() {
	_arch="$(uname -m)"
	case "$_arch" in
	arm64) echo -n 'aarch64-' ;;
	amd64) echo -n 'x86_64-' ;;
	*) echo -n "$_arch-" ;;
	esac

	case "$(uname -s | tr A-Z a-z)" in
	linux) echo -n 'linux-gnu' ;;
	*bsd) echo -n 'linux-gnu' ;;
	osx | darwin | mac*) echo -n 'macos-none' ;;
	esac
}

url="$GH_REPO/releases/download/v${ASDF_INSTALL_VERSION}/dt-$(host_zig_triple).tgz"

curl "$url" \
    -o "$ASDF_DOWNLOAD_PATH/" \
    -C -

tar -xzf "$release_file" \
    -C "$ASDF_DOWNLOAD_PATH"
